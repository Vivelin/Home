var __extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),TwitchStream=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.render=function(){var n="https://www.twitch.tv/"+this.props.user.login;return React.createElement("a",{href:n,target:"blank",rel:"external"},this.props.user.display_name," streaming ",this.props.stream.title)},t}(React.Component),TwitchFollows=function(n){function t(t){var i=n.call(this,t)||this;return i.state={user:null,streams:null,streamsUsers:null,errorName:null,errorMessage:null},i}return __extends(t,n),t.prototype.componentDidMount=function(){this.fetchUser();this.fetchStreams()},t.prototype.render=function(){var t=this,n=!this.state.user||!this.state.streams||!this.state.streamsUsers;return n&&!this.state.errorMessage?React.createElement("p",null,"Loading dataâ€¦"):n?this.state.errorName==="Unauthorized"?null:React.createElement("p",null,this.state.errorName,": ",this.state.errorMessage):React.createElement("ul",null,this.state.streams.map(function(n,i){var r=t.state.streamsUsers.filter(function(t){return t.id===n.user_id})[0];return React.createElement("li",{key:i},React.createElement(TwitchStream,{user:r,stream:n}))}))},t.prototype.fetchUser=function(){var n=this;this.sendRequest("users?id="+this.props.userId,function(t){n.setState({user:t.data[0]})})},t.prototype.fetchStreams=function(){var n=this;this.sendRequest("users/follows?first=100&from_id="+this.props.userId,function(t){var r="streams?user_id="+t.data.map(function(n){return n.to_id}).join("&user_id="),i;n.sendRequest(r,function(t){n.setState({streams:t.data})});i="users?id="+t.data.map(function(n){return n.to_id}).join("&id=");n.sendRequest(i,function(t){n.setState({streamsUsers:t.data})})})},t.prototype.sendRequest=function(n,t){var r=this,i=new XMLHttpRequest;i.onload=function(){var n=JSON.parse(i.responseText);n.error?r.setState({errorName:n.error,errorMessage:n.message}):t(n)};i.open("GET","https://api.twitch.tv/helix/"+n);i.setRequestHeader("Authorization","Bearer "+this.props.accessToken);i.send()},t}(React.Component),container=document.getElementById("twitch-follows"),userId,accessToken;container&&(userId=container.dataset.userId,accessToken=container.dataset.accessToken,ReactDOM.render(React.createElement(TwitchFollows,{userId:userId,accessToken:accessToken}),container));
//# sourceMappingURL=index.min.js.map